!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.textMaskCore=r():e.textMaskCore=r()}(self,(function(){return(()=>{"use strict";var e={d:(r,t)=>{for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};e.r(r),e.d(r,{adjustCaretPosition:()=>p,conformToMask:()=>f,createTextMaskInputElement:()=>C});var t="_",n=[];function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!i(e))throw new Error("Text-mask:convertMaskToPlaceholder; The mask property must be an array.");if(-1!==e.indexOf(r))throw new Error("Placeholder character must not be used as part of the mask. Please specify a character that is not present in your mask as your placeholder character.\n\n"+"The placeholder character that was received is: ".concat(JSON.stringify(r),"\n\n")+"The mask that was received is: ".concat(JSON.stringify(e)));return e.map((function(e){return e instanceof RegExp?r:e})).join("")}function i(e){return Array.isArray&&Array.isArray(e)||e instanceof Array}function a(e){return"string"==typeof e||e instanceof String}function u(e){for(var r,t=[];-1!==(r=e.indexOf("[]"));)t.push(r),e.splice(r,1);return{maskWithoutCaretTraps:e,indexes:t}}var l=[],s="";function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!i(r)){if("function"!=typeof r)throw new Error("Text-mask:conformToMask; The mask property must be an array.");r=u(r=r(e,n)).maskWithoutCaretTraps}var a=n.guide,f=void 0===a||a,c=n.previousConformedValue,d=void 0===c?s:c,p=n.placeholderChar,h=void 0===p?t:p,v=n.placeholder,m=void 0===v?o(r,h):v,g=n.currentCaretPosition,y=n.keepCharPositions,b=!1===f&&void 0!==d,O=e.length,C=d.length,P=m.length,k=r.length,w=O-C,x=w>0,j=g+(x?-w:0),T=j+Math.abs(w);if(!0===y&&!x){for(var S=s,V=j;V<T;V++)m[V]===h&&(S+=h);e=e.slice(0,j)+S+e.slice(j,O)}for(var E=e.split(s).map((function(e,r){return{char:e,isNew:r>=j&&r<T}})),M=O-1;M>=0;M--){var A=E[M].char;if(A!==h){var N=M>=j&&C===k;A===m[N?M-w:M]&&E.splice(M,1)}}var D=s,R=!1;e:for(var I=0;I<P;I++){var J=m[I];if(J===h){if(E.length>0)for(;E.length>0;){var W=E.shift(),_=W.char,q=W.isNew;if(_===h&&!0!==b){D+=h;continue e}if(r[I].test(_)){if(!0===y&&!1!==q&&d!==s&&!1!==f&&x){for(var F=E.length,L=null,z=0;z<F;z++){var B=E[z];if(B.char!==h&&!1===B.isNew)break;if(B.char===h){L=z;break}}null!==L?(D+=_,E.splice(L,1)):I--}else D+=_;continue e}R=!0}!1===b&&(D+=m.substr(I,P));break}D+=J}if(b&&!1===x){for(var G=null,H=0;H<D.length;H++)m[H]===h&&(G=H);D=null!==G?D.substr(0,G+1):s}return{conformedValue:D,meta:{someCharsRejected:R}}}var c=[],d="";function p(e){var r=e.previousConformedValue,t=void 0===r?d:r,n=e.previousPlaceholder,o=void 0===n?d:n,i=e.currentCaretPosition,a=void 0===i?0:i,u=e.conformedValue,l=e.rawValue,s=e.placeholderChar,f=e.placeholder,p=e.indexesOfPipedChars,h=void 0===p?c:p,v=e.caretTrapIndexes,m=void 0===v?c:v;if(0===a||!l.length)return 0;var g=l.length,y=t.length,b=f.length,O=u.length,C=g-y,P=C>0;if(C>1&&!P&&0!==y)return a;var k,w,x=0;if(!P||t!==u&&u!==f){var j=u.toLowerCase(),T=l.toLowerCase().substr(0,a).split(d).filter((function(e){return-1!==j.indexOf(e)}));w=T[T.length-1];var S=o.substr(0,T.length).split(d).filter((function(e){return e!==s})).length,V=f.substr(0,T.length).split(d).filter((function(e){return e!==s})).length!==S,E=void 0!==o[T.length-1]&&void 0!==f[T.length-2]&&o[T.length-1]!==s&&o[T.length-1]!==f[T.length-1]&&o[T.length-1]===f[T.length-2];!P&&(V||E)&&S>0&&f.indexOf(w)>-1&&void 0!==l[a]&&(k=!0,w=l[a]);for(var M=h.map((function(e){return j[e]})).filter((function(e){return e===w})).length,A=T.filter((function(e){return e===w})).length,N=f.substr(0,f.indexOf(s)).split(d).filter((function(e,r){return e===w&&l[r]!==e})).length+A+M+(k?1:0),D=0,R=0;R<O&&(x=R+1,j[R]===w&&D++,!(D>=N));R++);}else x=a-C;if(P){for(var I=x,J=x;J<=b;J++)if(f[J]===s&&(I=J),f[J]===s||-1!==m.indexOf(J)||J===b)return I}else if(k){for(var W=x-1;W>=0;W--)if(u[W]===w||-1!==m.indexOf(W)||0===W)return W}else for(var _=x;_>=0;_--)if(f[_-1]===s||-1!==m.indexOf(_)||0===_)return _}function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?h(Object(t),!0).forEach((function(r){m(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function m(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}var y="none",b="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),O="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:setTimeout;function C(e){var r={previousConformedValue:void 0,previousPlaceholder:void 0};return{state:r,update:function(n){var i,l,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,c=s.inputElement,d=s.mask,h=s.guide,m=s.pipe,y=s.placeholderChar,b=void 0===y?t:y,O=s.keepCharPositions,C=void 0!==O&&O,w=s.showMask,x=void 0!==w&&w;if(void 0===n&&(n=c.value),n!==r.previousConformedValue&&("object"===g(d)&&void 0!==d.pipe&&void 0!==d.mask&&(m=d.pipe,d=d.mask),d instanceof Array&&(i=o(d,b)),!1!==d)){var j,T=k(n),S=c.selectionEnd,V=r.previousConformedValue,E=r.previousPlaceholder;if("function"==typeof d){if(!1===(l=d(T,{currentCaretPosition:S,previousConformedValue:V,placeholderChar:b})))return;var M=u(l),A=M.maskWithoutCaretTraps,N=M.indexes;j=N,i=o(l=A,b)}else l=d;var D={previousConformedValue:V,guide:h,placeholderChar:b,pipe:m,placeholder:i,currentCaretPosition:S,keepCharPositions:C},R=f(T,l,D),I=R.conformedValue,J="function"==typeof m,W={};J&&(!1===(W=m(I,v({rawValue:T},D)))?W={value:V,rejected:!0}:a(W)&&(W={value:W}));var _=J?W.value:I,q=p({previousConformedValue:V,previousPlaceholder:E,conformedValue:_,placeholder:i,rawValue:T,currentCaretPosition:S,placeholderChar:b,indexesOfPipedChars:W.indexesOfPipedChars,caretTrapIndexes:j}),F=_===i&&0===q,L=x?i:"",z=F?L:_;r.previousConformedValue=z,r.previousPlaceholder=i,c.value!==z&&(c.value=z,P(c,q))}}}}function P(e,r){document.activeElement===e&&(b?O((function(){return e.setSelectionRange(r,r,y)}),0):e.setSelectionRange(r,r,y))}function k(e){if(a(e))return e;if("number"!=typeof(r=e)||void 0!==r.length||isNaN(r)){if(null==e)return"";throw new Error("The 'value' provided to Text Mask needs to be a string or a number. The value "+"received was:\n\n ".concat(JSON.stringify(e)))}return String(e);var r}return r})()}));